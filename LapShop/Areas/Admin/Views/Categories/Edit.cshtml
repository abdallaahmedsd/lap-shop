@*
    For more information on enabling MVC for empty projects, visit https://go.microsoft.com/fwlink/?LinkID=397860
*@
@{

}
@model TbCategory

@section Styles{
    <!-- Plugin css for this page -->
    <link rel="stylesheet" href="~/Admin/assets/vendors/dropify/dropify.min.css">
    <!-- End plugin css for this page -->
<link rel="stylesheet" href="~/Admin/assets/vendors/select2/select2.min.css">
    <link rel="stylesheet" href="~/Admin/assets/vendors/select2-bootstrap-theme/select2-bootstrap.min.css">
}


<div class="row">


<div class="col-md-6 grid-margin stretch-card">



<div class="card">
            <div style="padding:20px 20px 331px  20px"  class="card-body">
        <h4 class="card-title">Category Add/Update form</h4>
        <br />

                <form class="forms-sample" asp-action="Save" asp-controller="Categories" enctype="multipart/form-data" method="post" id="myForm">
                     <input asp-for="CategoryId" type="hidden" />
                    <input asp-for="CreatedDate" type="hidden" />
                    <input asp-for="CreatedBy" type="hidden" />
                    <input asp-for="ImageName" type="hidden" />

                    <div class="form-group">
                <label for="exampleInputUsername1">@ResAdmin.lblCategoryName</label>
                        <input asp-for="CategoryName"
                        type="text" 
                        class="form-control" 
                        id="exampleInputImageCategory1" 
                        placeholder="@ResAdmin.lblCategoryName">
                        <span asp-validation-for="CategoryName" class="text-danger"></span>
                    </div>


                    <div class="form-group">
                        <label class="col-sm-3 col-form-label">Image</label>
                        <input name ="files" type="file"  id="image_input" accept=".jpg,.jpeg,.png">
                        <span class="text-danger field-validation-valid" asp-validation-for="ImageName"></span>
                    </div>

                    @if (Model.ImageName != null)
                    {
                        <div class="col-sm-6" id="display_image">
                            <img value="@Model.ImageName" src="/Uploads/Category/@Model.ImageName" id="uploaded_image" style="width:95%; height:95%;" alt="Uploaded Image">
                            <p>Current image. Choose a new file to replace it.</p>
                        </div>
                    }
             

                    <div class="form-group">
                        <div class="form-check">
                            <label class="form-check-label">
                                <input type="checkbox" class="form-check-input"  asp-for="@Model.ShowInHomePage"> @ResAdmin.lblShowHomePage <i class="input-helper"></i>
                                <span asp-validation-for="ShowInHomePage" class="text-danger"></span>

                            </label>
                        </div>
                    </div><div class="form-group">
                        <div class="form-check">
                            <label class="form-check-label">
                                <input type="checkbox" class="form-check-input"  asp-for="@Model.CurrentState"> CurrentState <i class="input-helper"></i>
                                <span asp-validation-for="CurrentState" class="text-danger"></span>

                            </label>
                        </div>
                    </div>
            <button type="submit" class="btn btn-gradient-primary me-2">Submit</button>
        </form>
    </div>
</div>
</div>


</div>





@section Scripts {
    <!-- Plugin js for this page -->
    <script src="~/Admin/assets/vendors/dropify/dropify.min.js"></script>
    <!-- End plugin js for this page --> <!-- Custom js for this page -->
    <script src="~/Admin/assets/js/dropify.js"></script>
    <!-- End custom js for this page -->
    <script src="~/Admin/assets/js/file-upload.js"></script>
    <script src="~/Admin/assets/js/typeahead.js"></script>
    <script src="~/Admin/assets/js/select2.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.19.3/jquery.validate.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validation-unobtrusive/3.2.12/jquery.validate.unobtrusive.min.js"></script>

    <script>
     
          const image_input = document.querySelector("#image_input");
          const img_element = document.querySelector("#uploaded_image");

        console.log("image-input:\t", image_input);
        console.log("img_element:\t", img_element);

        if (img_element) {
            // If an existing image is present, remove the required validation
        }
        image_input.addEventListener("change", function () {
            const reader = new FileReader();
            reader.addEventListener("load", () => {
                img_element.src = reader.result;
            });
            reader.readAsDataURL(this.files[0]);
        });


        
    </script>
}